(()=>{"use strict";var e,t={5:(e,t,l)=>{const r=window.React,a=window.wp.blocks,o=window.wp.blockEditor,i=window.wp.components,s=window.wp.i18n,n=window.wp.data,c=window.wp.coreData,w=window.wp.apiFetch;var p=l.n(w);const v=window.wp.element,h=l.p+"images/brightlocal.ce7c0e6a.png",m=(0,r.createElement)("img",{src:h,alt:"BrightLocal",style:{width:24,height:24}}),g={google:"https://www.google.com/favicon.ico",facebook:"https://www.facebook.com/favicon.ico",yelp:"https://www.yelp.com/favicon.ico",tripadvisor:"https://www.tripadvisor.com/favicon.ico",brightlocal:"https://www.brightlocal.com/favicon.ico",yahoo:"https://www.yahoo.com/favicon.ico",default:"https://www.brightlocal.com/favicon.ico"};(0,a.registerBlockType)("brightlocal-reviews/reviews",{title:(0,s.__)("BrightLocal Reviews","brightlocal-reviews"),icon:m,category:"widgets",attributes:{displayType:{type:"string",default:"grid"},showAuthor:{type:"boolean",default:!0},showDate:{type:"boolean",default:!0},showSource:{type:"boolean",default:!0},reviewLabel:{type:"string",default:"all"},limitItems:{type:"boolean",default:!1},itemsPerPage:{type:"number",default:3},showArrows:{type:"boolean",default:!0}},edit:function(e){const{attributes:t,setAttributes:l}=e,a=(0,o.useBlockProps)(),[w,h]=(0,v.useState)([]),[m,b]=(0,v.useState)(1),[d,u]=(0,v.useState)(!0),_=(0,n.useSelect)((e=>e(c.store).getEntityRecords("taxonomy","bl_review_label",{per_page:-1,_fields:["id","name","slug"]})),[]),f=(0,n.useSelect)((e=>{const{getEntityRecords:l}=e(c.store),r={post_type:"bl-reviews",per_page:t.limitItems?t.itemsPerPage:100,_embed:!0,context:"edit",_fields:["id","title","content","date","meta"]};if(t.reviewLabel&&"all"!==t.reviewLabel){const e=l("taxonomy","bl_review_label",{per_page:-1,_fields:["id","slug"]});if(e){const l=e.find((e=>e.slug===t.reviewLabel));l&&(r.bl_review_label=l.id)}}return l("postType","bl-reviews",r)}),[t.reviewLabel,t.limitItems,t.itemsPerPage]);if((0,n.useSelect)((e=>e(c.store).isResolving("postType","bl-reviews")),[]))return(0,r.createElement)("div",{...a},(0,s.__)("Loading reviews...","brightlocal-reviews"));(0,v.useEffect)((()=>{h(f||[]),b(1),u(!0)}),[f,t.limitItems,t.itemsPerPage]);const y=[{label:(0,s.__)("All Reviews","brightlocal-reviews"),value:"all"}];_&&_.forEach((e=>{y.push({label:e.name,value:e.slug})}));const E=`bl-reviews-wrapper bl-reviews-${t.displayType} ${"carousel"===t.displayType?"bl-editor-preview":""}`;return[(0,r.createElement)(o.InspectorControls,null,(0,r.createElement)(i.PanelBody,{title:(0,s.__)("Display Settings","brightlocal-reviews")},(0,r.createElement)(i.SelectControl,{label:(0,s.__)("Review Group","brightlocal-reviews"),value:t.reviewLabel,options:y,onChange:e=>l({reviewLabel:e})}),(0,r.createElement)(i.SelectControl,{label:(0,s.__)("Display Type","brightlocal-reviews"),value:t.displayType,options:[{label:(0,s.__)("Grid","brightlocal-reviews"),value:"grid"},{label:(0,s.__)("List","brightlocal-reviews"),value:"list"},{label:(0,s.__)("Carousel","brightlocal-reviews"),value:"carousel"}],onChange:e=>l({displayType:e})}),(0,r.createElement)(i.ToggleControl,{label:(0,s.__)("Show Author","brightlocal-reviews"),checked:t.showAuthor,onChange:e=>l({showAuthor:e})}),(0,r.createElement)(i.ToggleControl,{label:(0,s.__)("Show Date","brightlocal-reviews"),checked:t.showDate,onChange:e=>l({showDate:e})}),(0,r.createElement)(i.ToggleControl,{label:(0,s.__)("Show Source","brightlocal-reviews"),checked:t.showSource,onChange:e=>l({showSource:e})}),(0,r.createElement)(i.ToggleControl,{label:(0,s.__)("Limit Reviews","brightlocal-reviews"),checked:t.limitItems,onChange:e=>l({limitItems:e})}),"carousel"===t.displayType&&(0,r.createElement)(i.ToggleControl,{label:(0,s.__)("Show Navigation Arrows","brightlocal-reviews"),checked:t.showArrows,onChange:e=>l({showArrows:e})}),t.limitItems&&(0,r.createElement)(i.RangeControl,{label:(0,s.__)("Reviews per page","brightlocal-reviews"),value:t.itemsPerPage,min:3,max:30,step:1,onChange:e=>l({itemsPerPage:e})}))),(0,r.createElement)("div",{...a},(0,r.createElement)("div",{className:E},(t.limitItems?w:f)&&(t.limitItems?w:f).length>0?(t.limitItems?w:f).map(((e,l)=>{const a=e.meta?._bl_rating||0,o=e.meta?._bl_source||"",i=(e.meta,e.meta?._bl_date||e.date),s=o.toLowerCase(),n=g[s]||g.default,c=e.content.rendered.replace(/<[^>]*>/g,"").length>200,w="bl-review-item "+("carousel"===t.displayType&&0===l?"active":"");return(0,r.createElement)("div",{key:e.id,className:w},(0,r.createElement)("div",{className:"bl-review-header"},(0,r.createElement)("div",{className:"bl-review-rating"},[...Array(5)].map(((e,t)=>(0,r.createElement)("span",{key:t,className:"star "+(t<a?"filled":"")},"â˜…")))),(0,r.createElement)("div",{className:"bl-review-meta-right"},t.showDate&&i&&(0,r.createElement)("span",{className:"bl-review-date"},new Date(i).toLocaleDateString()),t.showSource&&o&&(0,r.createElement)("span",{className:"bl-review-source"},(0,r.createElement)("img",{src:n,alt:o}),o.charAt(0).toUpperCase()+o.slice(1)))),t.showAuthor&&e.title.rendered&&(0,r.createElement)("div",{className:"bl-review-author"},e.title.rendered),(0,r.createElement)("div",{className:"bl-review-content "+(c?"collapsed":""),dangerouslySetInnerHTML:{__html:e.content.rendered}}),c&&(0,r.createElement)("div",{className:"bl-review-read-more"},"Read More"))})):(0,r.createElement)("p",null,(0,s.__)("No reviews found.","brightlocal-reviews"))),"carousel"!==t.displayType&&t.limitItems&&d&&(0,r.createElement)("button",{type:"button",className:"bl-reviews-load-more-editor",onClick:()=>{const e=m+1,l=t.itemsPerPage;let r=`/wp/v2/bl-reviews?per_page=${l}&page=${e}&context=edit&_embed=true`;t.reviewLabel&&"all"!==t.reviewLabel&&(r+=`&bl_review_label=${encodeURIComponent(t.reviewLabel)}`),p()({path:r}).then((t=>{t&&t.length>0?(h([...w,...t]),b(e),t.length<l&&u(!1)):u(!1)})).catch((()=>{u(!1)}))}},(0,s.__)("Load More","brightlocal-reviews")))]},save:function(){return null}})}},l={};function r(e){var a=l[e];if(void 0!==a)return a.exports;var o=l[e]={exports:{}};return t[e](o,o.exports,r),o.exports}r.m=t,e=[],r.O=(t,l,a,o)=>{if(!l){var i=1/0;for(w=0;w<e.length;w++){for(var[l,a,o]=e[w],s=!0,n=0;n<l.length;n++)(!1&o||i>=o)&&Object.keys(r.O).every((e=>r.O[e](l[n])))?l.splice(n--,1):(s=!1,o<i&&(i=o));if(s){e.splice(w--,1);var c=a();void 0!==c&&(t=c)}}return t}o=o||0;for(var w=e.length;w>0&&e[w-1][2]>o;w--)e[w]=e[w-1];e[w]=[l,a,o]},r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var l in t)r.o(t,l)&&!r.o(e,l)&&Object.defineProperty(e,l,{enumerable:!0,get:t[l]})},r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e;r.g.importScripts&&(e=r.g.location+"");var t=r.g.document;if(!e&&t&&(t.currentScript&&"SCRIPT"===t.currentScript.tagName.toUpperCase()&&(e=t.currentScript.src),!e)){var l=t.getElementsByTagName("script");if(l.length)for(var a=l.length-1;a>-1&&(!e||!/^http(s?):/.test(e));)e=l[a--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),r.p=e})(),(()=>{var e={57:0,350:0};r.O.j=t=>0===e[t];var t=(t,l)=>{var a,o,[i,s,n]=l,c=0;if(i.some((t=>0!==e[t]))){for(a in s)r.o(s,a)&&(r.m[a]=s[a]);if(n)var w=n(r)}for(t&&t(l);c<i.length;c++)o=i[c],r.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return r.O(w)},l=globalThis.webpackChunkbrightlocal_reviews=globalThis.webpackChunkbrightlocal_reviews||[];l.forEach(t.bind(null,0)),l.push=t.bind(null,l.push.bind(l))})();var a=r.O(void 0,[350],(()=>r(5)));a=r.O(a)})();